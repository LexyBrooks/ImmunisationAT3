---
title: "Step4_mergeelectorate"
author: "Alex Brooks"
date: "11 October 2018"
output: html_document
---
#Adding an election score
```{r setup, include=FALSE}
library(data.table)
library(readr)
library(dplyr)
library(tidyverse)
library(purrr)
```

## Bring in Step 3 cleaned data

 

```{r}
Step3 <- read.csv("../cleaned_data/all_immunisation_seifa.csv")
Scoredata <-read.csv("../raw_data/Transformed_elec.csv")
str(Scoredata)
```

```{r}
#The score data needs to be merged year by year
 
  
```
## Joining data
The tax data is actually all a year behind - so 2016 is actually 2015-16, 2015 is actually 2014-15 etc, which doesn't match the years in the postcode data.

Relations are always defined by a pair of tables - the property of the relations between each pair.
MUTATING: add new variables to one data frame from matching observations in another
FILTERING JOINS: filter observations from one df based on whether or not that maych an observation in the other table
SET OPERATIONS: treat observations as if they were set elements


```{r, fig.width=12, fig.height=15}
(fjsp <- full_join(Step3, Scoredata))
```

```{r}
str(fjsp)
```



#write to a clean data file
```{r}
#Write this to a file
write.csv(fjsp,"../cleaned_data/all_immunisation_elecscore.csv")

```

#let's look at the extra tax data
```{r}
taxdata <- read.csv("../raw_data/Tax2016_transformed.csv")
str(taxdata)
```
#clean this dtaa as they are all appearing as factors when should be numbers
```{r}
#transform factors to numbers
tax_individuals <- as.integer(taxdata$tax_individuals)
medicare_levy_surcharge_num <- as.integer(taxdata$medicare_levy_surcharge_num)
tax_on_taxable_income_num <- as.integer(taxdata$tax_on_taxable_income_num)
govt_allow_payments_num <- as.integer(taxdata$govt_allow_payments_num)
govt_pensions_allow_num <- as.integer(taxdata$govt_pensions_allow_num)
gifts_num <- as.integer(taxdata$gifts_num)
private_health_num <- as.integer(taxdata$private_health_num)
received_rebate_num <-as.integer(taxdata$received_rebate_num)
str(taxdata)
```



# the interesting variables are the numbers of people in each postcode, these manifest variables could indicate the latent variables
- tax_individuals - the number of people paying tax in the postcode
- medicare_levy_surcharge_num
- tax_on_taxable_income_num
- govt_allow_payments_num
- govt_pensions_allow_num
- gifts_num
- private_health_num

